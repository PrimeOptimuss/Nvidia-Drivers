#The prime-run stuff is for hybrid setup. AMD GPU and Nvidia RTX GPU for example

vim /etc/pacman.conf:
[multilib]
Include = /etc/pacman.d/mirrorlist
sudo pacman -Syu

vim /etc/default/grub
GRUB_CMDLINE_LINUX_DEFAULT=" whatever it says here you just add space and write this: nvidia_drm.modeset=1"

sudo grub-mkconfig -o /boot/grub/grub.cfg

cat /sys/module/nvidia_drm/parameters/modeset
should return Y

sudo vim /etc/mkinitcpio.conf:
Add these to the MODULES= line:
MODULES=(nvidia nvidia_modeset nvidia_uvm nvidia_drm)

sudo mkinitcpio -P
reboot
sudo vim ~/.bashrc:
alias prime-run='__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=nvidia __VK_LAYER_NV_optimus=NVIDIA_only'
source ~/.bashrc

verify:
glxinfo | grep "OpenGL renderer"
should show AMD

prime-run glxinfo | grep "OpenGL renderer"
should show NVIDIA
